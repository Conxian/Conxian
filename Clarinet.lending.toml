[project]
name = "conxian-lending"
description = "Lending system configuration for Conxian DeFi Protocol"
clarinet_version = "3.5.0"

[accounts]
# These values are for local development only
# In CI/CD, they are overridden by GitHub Secrets
deployer = { mnemonic = "${TESTNET_DEPLOYER_MNEMONIC:twice kind fence tip hidden tilt action fragile skin nothing glory cousin green tomorrow spring wrist shed math olympic multiply hip blue scout claw}", balance = 100_000_000_000_000 }
wallet_1 = { mnemonic = "${TESTNET_WALLET1_MNEMONIC:sell invite acquire kitten bamboo drastic jelly vivid peace spawn twice guilt pave pen trash pretty park cube fragile unaware remain midnight betray rebuild}", balance = 100_000_000_000_000 }
wallet_2 = { mnemonic = "${TESTNET_WALLET2_MNEMONIC:hold excess usual excess ring elephant install account glad dry fragile donkey gaze humble truck breeze nation gasp vacuum limb head keep delay hospital}", balance = 100_000_000_000_000 }

[network]
api_endpoint = "http://localhost:3999"
delay_execution_start = false

[network.testnet]
stacks_node_rpc_address = "https://api.testnet.hiro.so"
bitcoin_node_rpc_address = "https://blockstream.info/testnet/api"

[network.mainnet]
stacks_node_rpc_address = "https://api.hiro.so"
bitcoin_node_rpc_address = "https://blockstream.info/api"

# ===========================================
# LENDING SYSTEM CONFIGURATION
# ===========================================

[contracts.math-lib-advanced]
path = "contracts/lib/math-lib-advanced.clar"
epoch = "2.4"
depends_on = []

[contracts.fixed-point-math]
path = "contracts/lib/fixed-point-math.clar"
epoch = "2.4"
depends_on = ["math-lib-advanced"]

[contracts.precision-calculator]
path = "contracts/lib/precision-calculator.clar"
epoch = "2.4"
depends_on = ["math-lib-advanced", "fixed-point-math"]

[contracts.flash-loan-receiver-trait]
path = "contracts/traits/flash-loan-receiver-trait.clar"
epoch = "2.4"
depends_on = []

[contracts.lending-system-trait]
path = "contracts/traits/lending-system-trait.clar"
epoch = "2.4"
depends_on = ["flash-loan-receiver-trait"]

[contracts.interest-rate-model]
path = "contracts/dex/interest-rate-model.clar"
epoch = "2.4"
depends_on = ["fixed-point-math"]

[contracts.comprehensive-lending-system]
path = "contracts/dex/comprehensive-lending-system.clar"
epoch = "2.4"
depends_on = [
    "math-lib-advanced",
    "fixed-point-math", 
    "interest-rate-model",
    "lending-system-trait"
]

[contracts.enhanced-flash-loan-vault]
path = "contracts/dex/enhanced-flash-loan-vault.clar"
epoch = "2.4"
depends_on = [
    "math-lib-advanced",
    "fixed-point-math",
    "flash-loan-receiver-trait"
]

[contracts.loan-liquidation-manager]
path = "contracts/dex/loan-liquidation-manager.clar"
epoch = "2.4"
depends_on = [
    "comprehensive-lending-system",
    "fixed-point-math"
]

[contracts.lending-protocol-governance]
path = "contracts/governance/lending-protocol-governance.clar"
epoch = "2.4"
depends_on = [
    "comprehensive-lending-system",
    "loan-liquidation-manager"
]

# Existing core contracts that integrate with the new system
[contracts.vault]
path = "contracts/dex/vault.clar"
epoch = "2.4"
depends_on = ["enhanced-flash-loan-vault", "comprehensive-lending-system"]

[contracts.dex-router]
path = "contracts/dex/dex-router.clar"
epoch = "2.4"
depends_on = ["math-lib-advanced", "fixed-point-math"]

[contracts.cxd-token]
path = "contracts/tokens/cxd-token.clar"
epoch = "2.4"

[contracts.cxs-token]  
path = "contracts/tokens/cxs-token.clar"
epoch = "2.4"

# Integration with existing tokenomics
[contracts.token-system-coordinator]
path = "contracts/dex/token-system-coordinator.clar"
epoch = "2.4"
depends_on = [
    "comprehensive-lending-system",
    "lending-protocol-governance",
    "cxd-token",
    "cxs-token"
]

# Boot sequence for deployment
[[boot]]
depends_on = ["math-lib-advanced"]

[[boot]]
depends_on = ["fixed-point-math"]

[[boot]]
depends_on = ["precision-calculator"]

[[boot]]
depends_on = ["flash-loan-receiver-trait"]

[[boot]]
depends_on = ["lending-system-trait"]

[[boot]]
depends_on = ["interest-rate-model"]

[[boot]]
depends_on = ["comprehensive-lending-system"]

[[boot]]
depends_on = ["enhanced-flash-loan-vault"]

[[boot]]
depends_on = ["loan-liquidation-manager"]

[[boot]]
depends_on = ["lending-protocol-governance"]

