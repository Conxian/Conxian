;; native-stacking-operator.clar;; Stacks native STX stacking for operator security;; Replaces custom CXD bonding with native PoX security(define-constant ERR_UNAUTHORIZED (err u7000))(define-constant ERR_INSUFFICIENT_STAKE (err u7001))(define-constant ERR_NOT_REGISTERED (err u7002));; Minimum STX stake for operators (1000 STX)(define-constant MIN_OPERATOR_STAKE u1000000000);; Operator registry (no bonding required)(define-map operators principal {  registered-at: uint,  reputation-score: uint,  ;; 0-10000  operations-completed: uint,  last-operation: uint,});; Contract owner(define-data-var contract-owner principal tx-sender);; Register operator using native STX stacking(define-public (register-operator (operator principal))  (begin    (asserts! (is-eq tx-sender (var-get contract-owner)) ERR_UNAUTHORIZED)        ;; Check if operator has sufficient STX stake via native stacking    (let ((stx-balance (stx-get-balance operator)))      (asserts! (>= stx-balance MIN_OPERATOR_STAKE) ERR_INSUFFICIENT_STAKE)    )        (map-set operators operator {      registered-at: block-height,      reputation-score: u5000,  ;; Start at neutral      operations-completed: u0,      last-operation: u0,    })        (print {      event: "operator-registered",      operator: operator,      stake-required: MIN_OPERATOR_STAKE,      registered-at: block-height,    })    (ok true)  ));; Unregister operator(define-public (unregister-operator (operator principal))  (begin    (asserts! (or (is-eq tx-sender (var-get contract-owner))                  (is-eq tx-sender operator)) ERR_UNAUTHORIZED)        (map-delete operators operator)        (print {      event: "operator-unregistered",      operator: operator,      unregistered-at: block-height,    })    (ok true)  ));; Check if operator is registered and has sufficient stake(define-private (is-valid-operator (operator principal))  (let ((operator-data (map-get? operators operator))        (stx-balance (stx-get-balance operator)))    (and       (some? operator-data)      (>= stx-balance MIN_OPERATOR_STAKE)    )  ));; Update operator reputation after successful operation(define-private (update-operator-reputation (operator principal) (success bool))  (let ((operator-data (unwrap! (map-get? operators operator) false)))    (let ((current-rep (get reputation-score operator_data))          (current-ops (get operations-completed operator_data))          (rep-change (if success u100 u50)))  ;; +1% for success, -0.5% for failure      (map-set operators operator        (merge operator_data {          reputation-score: (min u10000 (max u0 (+ current-rep rep-change))),          operations-completed: (+ current-ops u1),          last-operation: block-height,        })      )    )  ));; Execute operation with operator validation(define-public (execute-authorized-operation (operation-id uint))  (begin    (asserts! (is-valid-operator tx-sender) ERR_NOT_REGISTERED)        ;; Update reputation for attempting operation    (update-operator-reputation tx-sender true)        (print {      event: "operation-executed",      operator: tx-sender,      operation-id: operation-id,      block: block-height,    })    (ok true)  ));; Read-only views(define-read-only (is-operator-registered (operator principal))  (ok (some? (map-get? operators operator))))(define-read-only (get-operator-info (operator principal))  (map-get? operators operator))(define-read-only (get-operator-reputation (operator principal))  (let ((operator-data (map-get? operators operator)))    (if (some? operator_data)      (ok (get reputation-score (unwrap! operator_data false)))      (ok u0)    )  ))(define-read-only (get-stake-requirement)  (ok MIN_OPERATOR_STAKE))(define-read-only (get-operator-count)  (ok (len (map-keys operators))));; Admin functions(define-public (set-contract-owner (new-owner principal))  (begin    (asserts! (is-eq tx-sender (var-get contract-owner)) ERR_UNAUTHORIZED)    (var-set contract-owner new-owner)    (ok true)  ));; Batch operations for efficiency(define-public (batch-register-operators (operators-list (list 10 principal)))  (begin    (asserts! (is-eq tx-sender (var-get contract-owner)) ERR_UNAUTHORIZED)        (fold register-operator_helper operators_list true)    (ok true)  ))(define-private (register-operator-helper (operator principal) (result bool))  (and result        (>= (stx-get-balance operator) MIN_OPERATOR_STAKE)       (begin         (map-set operators operator {           registered-at: block-height,           reputation-score: u5000,           operations-completed: u0,           last-operation: u0,         })         true       )  ))