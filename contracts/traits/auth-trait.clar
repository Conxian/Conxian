;; auth-trait.clar;; Shared authentication patterns for Conxian contracts(use-trait .error-handling-trait.error-handling);; ===== Role-Based Access Control =====(define-trait auth-trait  ((is-owner () (response bool uint))   (is-governance () (response bool uint))   (is-authorized (principal) (response bool uint))   (has-role ((string-ascii 32) principal) (response bool uint))));; ===== Common Authentication Patterns =====;; Owner-only access(define-read-only (check-owner (contract-owner principal))  (is-eq tx-sender contract-owner));; Governance access(define-read-only (check-governance (governance-contract principal))  (match (contract-call? governance-contract is-governance tx-sender)    result (is-eq result true)    false  ));; Role-based access(define-read-only (check-role (role (string-ascii 32)) (role-manager principal))  (match (contract-call? role-manager has-role role tx-sender)    result (is-eq result true)    false  ));; Multi-signature check(define-read-only (check-multisig (signatories (list 10 principal)) (threshold uint))  (let (    (current-sig-count (foldl       lambda         (sig acc)         (if (is-eq sig tx-sender) (+ acc u1) acc)      signatories      u0    ))  )    (>= current-sig-count threshold)  ));; ===== Common Guard Combinations =====;; Standard owner guard(define-private (owner-guard (contract-owner principal))  (begin    (asserts! (check-owner contract-owner) (standard-error ERR_UNAUTHORIZED))    true  ));; Standard governance guard(define-private (governance-guard (governance-contract principal))  (begin    (asserts! (check-governance governance-contract) (standard-error ERR_UNAUTHORIZED))    true  ));; Standard role guard(define-private (role-guard (role (string-ascii 32)) (role-manager principal))  (begin    (asserts! (check-role role role-manager) (standard-error ERR_UNAUTHORIZED))    true  ));; Paused contract guard(define-private (not-paused-guard (is-paused bool))  (begin    (asserts! (not is-paused) (standard-error ERR_PAUSED))    true  ));; ===== Authorization Helpers =====;; Check if caller can perform action based on multiple criteria(define-read-only (can-perform-action   (contract-owner principal)  (governance-contract principal)  (role-manager principal)  (required-role (optional (string-ascii 32)))  (is-paused bool))  (and    (not-paused-guard is-paused)    (match required-role      role (check-role role role-manager)      _ (or         (check-owner contract-owner)        (check-governance governance-contract)      )    )  ));; ===== Access Control Data Structures =====;; Role assignment tracking(define-map roles  { principal: principal }  { roles: (list 10 (string-ascii 32)) });; Permission levels(define-constant PERMISSION_NONE u0)(define-constant PERMISSION_READ u1)(define-constant PERMISSION_WRITE u2)(define-constant PERMISSION_ADMIN u3)(define-constant PERMISSION_OWNER u4);; Permission checking(define-read-only (has-permission   (user principal)   (required-level uint)  (contract-owner principal))  (let (    (user-roles (default-to (list) (map-get? roles { principal: user })))    (user-level (foldl      lambda        (role acc)        (match role          "owner" (max acc PERMISSION_OWNER)          "admin" (max acc PERMISSION_ADMIN)          "write" (max acc PERMISSION_WRITE)          "read" (max acc PERMISSION_READ)          _ acc        )      user-roles      PERMISSION_NONE    ))  )    (or      (>= user-level required-level)      (is-eq user contract-owner)    )  ))